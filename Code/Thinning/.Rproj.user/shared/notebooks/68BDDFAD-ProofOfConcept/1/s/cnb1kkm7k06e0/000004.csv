"0","IHS = function(y, lambda = 0)"
"0","{"
"0","  return(log(lambda*y + sqrt(lambda^2*y^2 + 1)) / lambda)"
"0","}"
"0","n = 1000"
"0","p = 2"
"0","seqVect = seq(.2, 3, .2)"
"0","df = data.frame(x = rep(seqVect, each = length(seqVect)), y = rep(seqVect, length(seqVect)))"
"0","fun = function(xy, dat)"
"0","{"
"0","  X.ihs = cbind(IHS(dat[,1], lambda = xy[1]), IHS(dat[,2], lambda = xy[2]))"
"0","  km = kmeans(X.ihs, 2, nstart = 1000)"
"0","  return((n*p/2)*log(km$tot.withinss) - logjac(xy, dat))"
"0","}"
"0","logjac = function(lambda, dat)"
"0","{"
"0","  jac1 =  1/sqrt(lambda[1]^2*dat[,1]^2 + 1)"
"0","  jac2 =  1/sqrt(lambda[2]^2*dat[,2]^2 + 1)"
"0","  "
"0","  return(sum(log(jac1) + log(jac2)))"
"0","}"
"0","df$WSS = apply(df, 1, fun, dat = X)"
"0","lambdaChoice = c(df$x[which.min(df$WSS)], df$y[which.min(df$WSS)])"
"0","X.ihs = data.frame(V1 = IHS(X[,1], lambda = lambdaChoice[1]), V2 = IHS(X[,2], lambda = lambdaChoice[2]))"
"0","  "
"0","ggplot(df) + geom_tile(aes(x = x, y = y, fill = WSS)) + scale_fill_continuous(low = ""white"", high = ""darkblue"") + geom_point(x = lambdaChoice[1], y = lambdaChoice[2], shape = ""X"") + xlab(expression(lambda[1])) + ylab(expression(lambda[2])) + theme_bw()"
